<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>确认预约</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .section { margin-bottom: 20px; }
        #Image1 { font-weight: bold; font-size: 24px; background: #eee; padding: 5px; letter-spacing: 5px; }
    .time-options { display: grid; grid-template-columns: repeat(8, 1fr); gap: 8px; }
    .time-option { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 8px; border: 1px solid #eee; border-radius: 4px; }
    .time-option input { margin-bottom: 6px; }
    .time-option label { display: block; }
    .disabled { color: red; cursor: not-allowed; }
    .enabled { color: blue; cursor: pointer; }
        button { padding: 8px 16px; }
    </style>
</head>
<body>
    <h2>请完成预约确认</h2>

    <!-- 第一部分：验证码 -->
    <div class="section">
        <label>图形验证：</label>
        <input type="text" id="txtTxYz" placeholder="请输入验证码">
        <span id="Image1">IfWz</span>
        <a href="javascript:void(0)" id="LinkButton1">点此刷新验证码</a>
    </div>

    <!-- 第二部分：时间选择 -->
    <div class="section" id="Panel1">
        <h3>选择预约时间</h3>
        <div class="time-options" id="timeOptionsContainer">
            <!-- 将由脚本动态生成 4 行 x 8 列 的时间选项 -->
        </div>
    </div>

    <!-- 第三部分：提交按钮 -->
    <div class="section">
        <button id="btnConfirm">提交</button>
    </div>

    <script>
        // 刷新验证码
        document.getElementById('LinkButton1').addEventListener('click', function() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let code = '';
            for (let i = 0; i < 4; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            document.getElementById('Image1').textContent = code;
        });

        // 提交按钮逻辑
        document.getElementById('btnConfirm').addEventListener('click', function() {
            const captcha = document.getElementById('txtTxYz').value.trim().toLowerCase();
            const correctCaptcha = document.getElementById('Image1').textContent.toLowerCase();

            if (captcha !== correctCaptcha) {
                alert('验证码错误');
                return;
            }

            // 检查是否选中了可用时间
            const selected = document.querySelector('input[name="time"]:checked');
            if (!selected) {
                alert('请先选择一个时间');
                return;
            }

            // 检查是否选中了禁用项
            if (selected.classList.contains('disabled')) {
                alert('当前选择的时间不可用');
                return;
            }

            // 成功跳转
            window.location.href = 'success.html';
        });

        // 动态生成 4 行 x 8 列 时间选项（共 32 个）
        (function generateTimeOptions() {
            const container = document.getElementById('timeOptionsContainer');
            // 样式通过 CSS 控制为 4x8，从而自动换行
            // 我们从 13:30 开始，每个选项间隔 7 分钟（可按需调整）
            const total = 32;
            const startHour = 13, startMinute = 30;
            function pad(n){ return n.toString().padStart(2,'0'); }

            // 设定被禁用的索引（示例：每 4 个禁用一个）
            const disabledIdx = new Set([3,7,11,15,19,23,27,31]);

            for (let i = 0; i < total; i++) {
                const minutes = startHour * 60 + startMinute + i * 7;
                const hh = Math.floor(minutes / 60) % 24;
                const mm = minutes % 60;
                const timeLabel = `${pad(hh)}:${pad(mm)}`;

                const div = document.createElement('div');
                div.className = 'time-option';

                const input = document.createElement('input');
                input.type = 'radio';
                input.name = 'time';
                input.id = `RadioButton${i}`;

                const label = document.createElement('label');
                label.htmlFor = input.id;
                label.textContent = timeLabel;

                if (disabledIdx.has(i)) {
                    input.className = 'disabled';
                    input.disabled = true;
                    label.className = 'disabled';
                } else {
                    input.className = 'enabled';
                    label.className = 'enabled';
                }

                div.appendChild(input);
                div.appendChild(label);
                container.appendChild(div);
            }
        })();
    </script>
</body>
</html>